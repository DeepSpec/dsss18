<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>DeepWeb.Test.TestExternal</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library DeepWeb.Test.TestExternal</h1>

<div class="code">
<span class="comment">(*!&nbsp;Section&nbsp;ExternalTest&nbsp;*)</span><br/>

<br/>
<span class="comment">(*&nbsp;Run&nbsp;the&nbsp;C&nbsp;server&nbsp;("external"&nbsp;to&nbsp;Coq)&nbsp;to&nbsp;get&nbsp;traces&nbsp;for<br/>
&nbsp;&nbsp;&nbsp;testing.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Type</span><span class="id" title="var">classes</span> <span class="id" title="tactic">eauto</span> := 3.<br/>

<br/>
<span class="id" title="var">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Program.Basics.html#"><span class="id" title="library">Basics</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Strings.String.html#"><span class="id" title="library">String</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.ZArith.ZArith.html#"><span class="id" title="library">ZArith</span></a>.<br/>
<span class="id" title="var">From</span> <span class="id" title="var">ExtLib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="library">Functor</span> <span class="id" title="library">Traversable</span> <span class="id" title="library">List</span> <span class="id" title="library">OptionMonad</span> <span class="id" title="library">StateMonad</span>.<br/>
<span class="id" title="var">From</span> <span class="id" title="var">QuickChick</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">QuickChick</span>.<br/>
<span class="id" title="var">From</span> <span class="id" title="var">DeepWeb</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="DeepWeb.Test.Client.html#"><span class="id" title="library">Test.Client</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="DeepWeb.Lib.Util.html#"><span class="id" title="library">Lib.Util</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="DeepWeb.Lib.SimpleSpec.html#"><span class="id" title="library">Lib.SimpleSpec</span></a>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">FunctorNotation</span> <span class="id" title="var">ListNotations</span> <span class="id" title="var">MonadNotation</span>.<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">program_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="filterSome"><span class="id" title="definition">filterSome</span></a> {<span class="id" title="var">A</span>} (<span class="id" title="var">l</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#A"><span class="id" title="variable">A</span></a>)) : <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#A"><span class="id" title="variable">A</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a> <span class="id" title="var">l</span> ⇒ <span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#filterSome"><span class="id" title="definition">filterSome</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#l"><span class="id" title="variable">l</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a> <span class="id" title="var">l</span> ⇒ <a class="idref" href="DeepWeb.Test.TestExternal.html#filterSome"><span class="id" title="definition">filterSome</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#l"><span class="id" title="variable">l</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="recv_external"><span class="id" title="definition">recv_external</span></a> (<span class="id" title="var">cid_fd</span> : <a class="idref" href="DeepWeb.Lib.Util.html#connection_id"><span class="id" title="inductive">connection_id</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">×</span></a> <a class="idref" href="DeepWeb.Test.Client.html#file_descr"><span class="id" title="axiom">file_descr</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="DeepWeb.Test.Client.html#IO"><span class="id" title="axiom">IO</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="DeepWeb.Lib.SimpleSpec_Traces.html#real_event"><span class="id" title="definition">real_event</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">cid</span>, <span class="id" title="var">fd</span>) := <a class="idref" href="DeepWeb.Test.TestExternal.html#cid_fd"><span class="id" title="variable">cid_fd</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">ob</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="DeepWeb.Test.Client.html#recvb"><span class="id" title="axiom">recvb</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#fd"><span class="id" title="variable">fd</span></a><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;<span class="id" title="method">ret</span> (<a class="idref" href="DeepWeb.Lib.SimpleSpec_Traces.html#FromServer"><span class="id" title="constructor">FromServer</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#cid"><span class="id" title="variable">cid</span></a> <span class="id" title="notation">&lt;$&gt;</span> <span class="id" title="notation">(</span><a class="idref" href="DeepWeb.Test.TestExternal.html#ob"><span class="id" title="variable">ob</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="DeepWeb.Lib.Util.html#byte"><span class="id" title="definition">byte</span></a><span class="id" title="notation">)</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="Client"><span class="id" title="definition">Client</span></a> := <span class="id" title="record">stateT</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="DeepWeb.Lib.Util.html#connection_id"><span class="id" title="inductive">connection_id</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">×</span></a> <a class="idref" href="DeepWeb.Test.Client.html#file_descr"><span class="id" title="axiom">file_descr</span></a>)) <a class="idref" href="DeepWeb.Test.Client.html#IO"><span class="id" title="axiom">IO</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="pick_error"><span class="id" title="definition">pick_error</span></a> {<span class="id" title="var">A</span>} (<span class="id" title="var">l</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#A"><span class="id" title="variable">A</span></a>) : <a class="idref" href="DeepWeb.Test.Client.html#IO"><span class="id" title="axiom">IO</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#A"><span class="id" title="variable">A</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a> ⇒ <span class="id" title="method">ret</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">a0</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">n</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="DeepWeb.Test.Client.html#rand"><span class="id" title="axiom">rand</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">length</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#l"><span class="id" title="variable">l</span></a>)<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">ret</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#nth"><span class="id" title="definition">nth</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="var">a0</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="pick"><span class="id" title="definition">pick</span></a> {<span class="id" title="var">A</span>} (<span class="id" title="var">l</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#A"><span class="id" title="variable">A</span></a>) (<span class="id" title="var">a0</span> : <a class="idref" href="DeepWeb.Test.TestExternal.html#A"><span class="id" title="variable">A</span></a>) : <a class="idref" href="DeepWeb.Test.Client.html#IO"><span class="id" title="axiom">IO</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#A"><span class="id" title="variable">A</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">oa</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#pick_error"><span class="id" title="definition">pick_error</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#l"><span class="id" title="variable">l</span></a><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;<span class="id" title="method">ret</span> (<span class="id" title="keyword">match</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#oa"><span class="id" title="variable">oa</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="DeepWeb.Test.TestExternal.html#a0"><span class="id" title="variable">a0</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a</span> ⇒ <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="max_connections"><span class="id" title="definition">max_connections</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> := 4.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="newConnection"><span class="id" title="definition">newConnection</span></a> : <a class="idref" href="DeepWeb.Test.TestExternal.html#Client"><span class="id" title="definition">Client</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="DeepWeb.Lib.Util.html#connection_id"><span class="id" title="inductive">connection_id</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">×</span></a> <a class="idref" href="DeepWeb.Test.Client.html#file_descr"><span class="id" title="axiom">file_descr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">×</span></a> <a class="idref" href="DeepWeb.Lib.SimpleSpec_Traces.html#real_trace"><span class="id" title="definition">real_trace</span></a>)) :=<br/>
&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#log"><span class="id" title="axiom">log</span></a> "new connection")<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;<span class="id" title="var">connections</span> <span class="id" title="notation">&lt;-</span> <span class="id" title="method">get</span><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#connections"><span class="id" title="variable">connections</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ofd</span> <span class="id" title="notation">&lt;-</span> <span class="id" title="method">lift</span> <a class="idref" href="DeepWeb.Test.Client.html#socket"><span class="id" title="axiom">socket</span></a><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#ofd"><span class="id" title="variable">ofd</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">fd</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">c</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="DeepWeb.Lib.Util.html#Connection"><span class="id" title="constructor">Connection</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">fd</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">put</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a><a class="idref" href="DeepWeb.Test.TestExternal.html#c"><span class="id" title="variable">c</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">ret</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="DeepWeb.Test.TestExternal.html#c"><span class="id" title="variable">c</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a><a class="idref" href="DeepWeb.Lib.SimpleSpec_Traces.html#NewConnection"><span class="id" title="constructor">NewConnection</span></a> (<a class="idref" href="DeepWeb.Lib.Util.html#Connection"><span class="id" title="constructor">Connection</span></a> 0)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <span class="id" title="method">ret</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">c0</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">length</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#connections"><span class="id" title="variable">connections</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Arith.PeanoNat.html#558f8b76d149cdb311ec341fe9014aa8"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#max_connections"><span class="id" title="definition">max_connections</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ofd</span> <span class="id" title="notation">&lt;-</span> <span class="id" title="method">lift</span> <a class="idref" href="DeepWeb.Test.Client.html#socket"><span class="id" title="axiom">socket</span></a><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#ofd"><span class="id" title="variable">ofd</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">fd</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">c</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="DeepWeb.Lib.Util.html#Connection"><span class="id" title="constructor">Connection</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">length</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#connections"><span class="id" title="variable">connections</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">fd</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">put</span> (<a class="idref" href="DeepWeb.Test.TestExternal.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#connections"><span class="id" title="variable">connections</span></a>)<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">ret</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="DeepWeb.Test.TestExternal.html#c"><span class="id" title="variable">c</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a><a class="idref" href="DeepWeb.Lib.SimpleSpec_Traces.html#NewConnection"><span class="id" title="constructor">NewConnection</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#c"><span class="id" title="variable">c</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <span class="id" title="method">ret</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="method">ret</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">c0</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="sendMessage"><span class="id" title="definition">sendMessage</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">cid</span> : <a class="idref" href="DeepWeb.Lib.Util.html#connection_id"><span class="id" title="inductive">connection_id</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">fd</span> : <a class="idref" href="DeepWeb.Test.Client.html#file_descr"><span class="id" title="axiom">file_descr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">b</span> : <a class="idref" href="DeepWeb.Lib.Util.html#byte"><span class="id" title="definition">byte</span></a>) : <a class="idref" href="DeepWeb.Test.TestExternal.html#Client"><span class="id" title="definition">Client</span></a> <a class="idref" href="DeepWeb.Lib.SimpleSpec_Traces.html#real_event"><span class="id" title="definition">real_event</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#log"><span class="id" title="axiom">log</span></a> ("sending " <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> <span class="id" title="method">show</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#b"><span class="id" title="variable">b</span></a>))<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#sendb"><span class="id" title="axiom">sendb</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#fd"><span class="id" title="variable">fd</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#b"><span class="id" title="variable">b</span></a>)<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;<span class="id" title="method">ret</span> (<a class="idref" href="DeepWeb.Lib.SimpleSpec_Traces.html#ToServer"><span class="id" title="constructor">ToServer</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#cid"><span class="id" title="variable">cid</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#b"><span class="id" title="variable">b</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="recvMessages"><span class="id" title="definition">recvMessages</span></a> : <a class="idref" href="DeepWeb.Test.TestExternal.html#Client"><span class="id" title="definition">Client</span></a> <a class="idref" href="DeepWeb.Lib.SimpleSpec_Traces.html#real_trace"><span class="id" title="definition">real_trace</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">l</span> <span class="id" title="notation">&lt;-</span> <span class="id" title="method">get</span><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.TestExternal.html#filterSome"><span class="id" title="definition">filterSome</span></a> <span class="id" title="notation">&lt;$&gt;</span> <span class="id" title="method">mapT</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#recv_external"><span class="id" title="definition">recv_external</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#l"><span class="id" title="variable">l</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="closeAll"><span class="id" title="definition">closeAll</span></a> : <a class="idref" href="DeepWeb.Test.TestExternal.html#Client"><span class="id" title="definition">Client</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#unit"><span class="id" title="inductive">unit</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#log"><span class="id" title="axiom">log</span></a> ("closing all connections"))<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;<span class="id" title="var">connections</span> <span class="id" title="notation">&lt;-</span> <span class="id" title="method">get</span><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;<span class="id" title="method">put</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;<span class="id" title="method">mapT</span> (<span class="id" title="method">lift</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Program.Basics.html#23b053569700a43fa034e3971fb6ded6"><span class="id" title="notation">∘</span></a> <a class="idref" href="DeepWeb.Test.Client.html#close"><span class="id" title="axiom">close</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Program.Basics.html#23b053569700a43fa034e3971fb6ded6"><span class="id" title="notation">∘</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a>) <a class="idref" href="DeepWeb.Test.TestExternal.html#connections"><span class="id" title="variable">connections</span></a>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="execute'"><span class="id" title="definition">execute'</span></a> (<span class="id" title="var">fuel</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">msgs</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="DeepWeb.Lib.Util.html#byte"><span class="id" title="definition">byte</span></a>) : <a class="idref" href="DeepWeb.Test.TestExternal.html#Client"><span class="id" title="definition">Client</span></a> <a class="idref" href="DeepWeb.Lib.SimpleSpec_Traces.html#real_trace"><span class="id" title="definition">real_trace</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#log"><span class="id" title="axiom">log</span></a> ("exec " <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> <span class="id" title="method">show</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#fuel"><span class="id" title="variable">fuel</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> " " <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> <span class="id" title="method">show</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#msgs"><span class="id" title="variable">msgs</span></a>))<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#fuel"><span class="id" title="variable">fuel</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| 0 ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#log"><span class="id" title="axiom">log</span></a> "out of fuel, closing all connections")<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="DeepWeb.Test.TestExternal.html#closeAll"><span class="id" title="definition">closeAll</span></a><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">ret</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">fuel</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#msgs"><span class="id" title="variable">msgs</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#log"><span class="id" title="axiom">log</span></a> ("nothing to send, receiving messages"))<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">connections</span> <span class="id" title="notation">&lt;-</span> <span class="id" title="method">get</span><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tr</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#recvMessages"><span class="id" title="definition">recvMessages</span></a><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#log"><span class="id" title="axiom">log</span></a> ("received " <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> <span class="id" title="method">show</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#tr"><span class="id" title="variable">tr</span></a>))<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="DeepWeb.Test.TestExternal.html#closeAll"><span class="id" title="definition">closeAll</span></a><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">ret</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#tr"><span class="id" title="variable">tr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">msg</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">msgs'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">connections</span> <span class="id" title="notation">&lt;-</span> <span class="id" title="method">get</span><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#connections"><span class="id" title="variable">connections</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#log"><span class="id" title="axiom">log</span></a> "flip true, creating first connection")<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ocft</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#newConnection"><span class="id" title="definition">newConnection</span></a><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#ocft"><span class="id" title="variable">ocft</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">cft</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">cf</span>, <span class="id" title="var">tr</span>) := <span class="id" title="var">cft</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">cid</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#cf"><span class="id" title="variable">cf</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#log"><span class="id" title="axiom">log</span></a> ("created connection " <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> <span class="id" title="method">show</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#cid"><span class="id" title="variable">cid</span></a>))<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tr'</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#execute'"><span class="id" title="definition">execute'</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#fuel"><span class="id" title="variable">fuel</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#msgs"><span class="id" title="variable">msgs</span></a><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">ret</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#app"><span class="id" title="definition">app</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#tr"><span class="id" title="variable">tr</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#tr'"><span class="id" title="variable">tr'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#log"><span class="id" title="axiom">log</span></a> "failed to create connection, skipping")<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="DeepWeb.Test.TestExternal.html#execute'"><span class="id" title="definition">execute'</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#fuel"><span class="id" title="variable">fuel</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#msgs"><span class="id" title="variable">msgs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">c0</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">b</span> <span class="id" title="notation">&lt;-</span> <span class="id" title="method">lift</span> <a class="idref" href="DeepWeb.Test.Client.html#flip"><span class="id" title="axiom">flip</span></a><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#b"><span class="id" title="variable">b</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#log"><span class="id" title="axiom">log</span></a> "flip true, sending messages")<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">n</span> <span class="id" title="notation">&lt;-</span> <span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#rand"><span class="id" title="axiom">rand</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">length</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#connections"><span class="id" title="variable">connections</span></a>))<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">cid</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">fd</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#nth"><span class="id" title="definition">nth</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#connections"><span class="id" title="variable">connections</span></a> <span class="id" title="var">c0</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ev</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#sendMessage"><span class="id" title="definition">sendMessage</span></a> <span class="id" title="var">cid</span> <span class="id" title="var">fd</span> <span class="id" title="var">msg</span><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#log"><span class="id" title="axiom">log</span></a> ("sent " <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> <span class="id" title="method">show</span> <span class="id" title="var">msg</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> " to " <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> <span class="id" title="method">show</span> <span class="id" title="var">cid</span>))<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tr'</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#execute'"><span class="id" title="definition">execute'</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#fuel"><span class="id" title="variable">fuel</span></a> <span class="id" title="var">msgs'</span><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">ret</span> (<a class="idref" href="DeepWeb.Test.TestExternal.html#ev"><span class="id" title="variable">ev</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="DeepWeb.Test.TestExternal.html#tr'"><span class="id" title="variable">tr'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">b</span> <span class="id" title="notation">&lt;-</span> <span class="id" title="method">lift</span> <a class="idref" href="DeepWeb.Test.Client.html#flip"><span class="id" title="axiom">flip</span></a><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#b"><span class="id" title="variable">b</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#log"><span class="id" title="axiom">log</span></a> "flip false-true, receiving messages")<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">connections</span> <span class="id" title="notation">&lt;-</span> <span class="id" title="method">get</span><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tr</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#recvMessages"><span class="id" title="definition">recvMessages</span></a><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#log"><span class="id" title="axiom">log</span></a> ("received " <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> <span class="id" title="method">show</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#tr"><span class="id" title="variable">tr</span></a>))<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tr'</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#execute'"><span class="id" title="definition">execute'</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#fuel"><span class="id" title="variable">fuel</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#msgs"><span class="id" title="variable">msgs</span></a><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">ret</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#app"><span class="id" title="definition">app</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#tr"><span class="id" title="variable">tr</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#tr'"><span class="id" title="variable">tr'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#log"><span class="id" title="axiom">log</span></a> "flip false-false, creating connection")<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ocft</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#newConnection"><span class="id" title="definition">newConnection</span></a><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#ocft"><span class="id" title="variable">ocft</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">cid</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">tr</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#log"><span class="id" title="axiom">log</span></a> ("created connection " <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> <span class="id" title="method">show</span> <span class="id" title="var">cid</span>))<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tr'</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#execute'"><span class="id" title="definition">execute'</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#fuel"><span class="id" title="variable">fuel</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#msgs"><span class="id" title="variable">msgs</span></a><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">ret</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#app"><span class="id" title="definition">app</span></a> <span class="id" title="var">tr</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#tr'"><span class="id" title="variable">tr'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#log"><span class="id" title="axiom">log</span></a> "failed to create connection, skipping")<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="DeepWeb.Test.TestExternal.html#execute'"><span class="id" title="definition">execute'</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#fuel"><span class="id" title="variable">fuel</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#msgs"><span class="id" title="variable">msgs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="execute"><span class="id" title="definition">execute</span></a> (<span class="id" title="var">msgs</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="DeepWeb.Lib.Util.html#byte"><span class="id" title="definition">byte</span></a>) : <a class="idref" href="DeepWeb.Test.TestExternal.html#Client"><span class="id" title="definition">Client</span></a> <a class="idref" href="DeepWeb.Lib.SimpleSpec_Traces.html#real_trace"><span class="id" title="definition">real_trace</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#log"><span class="id" title="axiom">log</span></a> (<span class="id" title="definition">nl</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> "Execute: "<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> <span class="id" title="method">show</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#msgs"><span class="id" title="variable">msgs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> <span class="id" title="definition">nl</span>))<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;<span class="id" title="var">tr</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#execute'"><span class="id" title="definition">execute'</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">length</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#msgs"><span class="id" title="variable">msgs</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">×</span></a> 10) <a class="idref" href="DeepWeb.Test.TestExternal.html#msgs"><span class="id" title="variable">msgs</span></a><span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;<span class="id" title="method">lift</span> (<a class="idref" href="DeepWeb.Test.Client.html#log"><span class="id" title="axiom">log</span></a> (<span class="id" title="definition">nl</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> "Trace: " <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> <span class="id" title="method">show</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#tr"><span class="id" title="variable">tr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> <span class="id" title="definition">nl</span>))<span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;<span class="id" title="method">ret</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#tr"><span class="id" title="variable">tr</span></a>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <a name="showResult"><span class="id" title="instance">showResult</span></a> {<span class="id" title="var">A</span> <span class="id" title="var">CE</span> : <span class="id" title="keyword">Type</span>} `{<span class="id" title="class">Show</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#A"><span class="id" title="variable">A</span></a>} `{<span class="id" title="class">Show</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#CE"><span class="id" title="variable">CE</span></a>}: <span class="id" title="class">Show</span> (<a class="idref" href="DeepWeb.Lib.Util.html#result"><span class="id" title="inductive">result</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#CE"><span class="id" title="variable">CE</span></a>) :=<br/>
&nbsp;&nbsp;{| <span class="id" title="constructor">show</span> <span class="id" title="constructor">r</span> <span class="id" title="constructor">:=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="constructor">match</span> <span class="id" title="constructor">r</span> <span class="id" title="constructor">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="constructor">|</span> <span class="id" title="constructor">OK</span> <span class="id" title="constructor">a</span>   <span class="id" title="constructor">⇒</span> "Found " <span class="id" title="constructor">++</span> <span class="id" title="constructor">show</span> <span class="id" title="constructor">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="constructor">|</span> <span class="id" title="constructor">FAIL</span> <span class="id" title="constructor">ce</span>  <span class="id" title="constructor">⇒</span> "Not Found (counterexample: " <span class="id" title="constructor">++</span> <span class="id" title="constructor">show</span> <span class="id" title="constructor">ce</span> <span class="id" title="constructor">++</span> ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="constructor">|</span> <span class="id" title="constructor">DONTKNOW</span> <span class="id" title="constructor">⇒</span> "Out of Fuel"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="constructor">end</span> |}.<br/>

<br/>
<span class="id" title="keyword">Require</span> <a class="idref" href="DeepWeb.Spec.Swap_SimpleSpec.html#"><span class="id" title="library">DeepWeb.Spec.Swap_SimpleSpec</span></a>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <a name="genMoreBytes"><span class="id" title="instance">genMoreBytes</span></a> : <span class="id" title="class">GenSized</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="DeepWeb.Lib.Util.html#byte"><span class="id" title="definition">byte</span></a>) :=<br/>
&nbsp;&nbsp;{| <span class="id" title="constructor">arbitrarySized</span> <span class="id" title="constructor">:=</span> <span class="id" title="constructor">arbitrarySized</span> <span class="id" title="constructor">∘</span> <span class="id" title="constructor">(</span><span class="id" title="constructor">mult</span> <span class="id" title="constructor">10)</span> |}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="execute_prop'"><span class="id" title="definition">execute_prop'</span></a> (<span class="id" title="var">msgs</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="DeepWeb.Lib.Util.html#byte"><span class="id" title="definition">byte</span></a>) : <span class="id" title="definition">Checker</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="DeepWeb.Test.Client.html#runIO_with_server"><span class="id" title="definition">runIO_with_server</span></a> (<span class="id" title="definition">evalStateT</span> (<a class="idref" href="DeepWeb.Test.TestExternal.html#execute"><span class="id" title="definition">execute</span></a> <a class="idref" href="DeepWeb.Test.TestExternal.html#msgs"><span class="id" title="variable">msgs</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <span class="id" title="definition">collect</span> "Ignored socket exception" (<span class="id" title="method">checker</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#tt"><span class="id" title="constructor">tt</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">tr</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="DeepWeb.Lib.SimpleSpec_Traces.html#is_FromServer"><span class="id" title="definition">is_FromServer</span></a> <span class="id" title="var">tr</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a> ⇒ <span class="id" title="definition">collect</span> "No Response" (<span class="id" title="method">checker</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#tt"><span class="id" title="constructor">tt</span></a>) <span class="comment">(*&nbsp;If&nbsp;the&nbsp;server&nbsp;never&nbsp;said&nbsp;anything,&nbsp;no&nbsp;point&nbsp;checking.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a> <span class="id" title="var">_</span> ⇒ <span class="id" title="definition">whenFail</span> (<span class="id" title="method">show</span> <span class="id" title="var">tr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="DeepWeb.Lib.SimpleSpec_Descramble.html#is_scrambled_trace_test"><span class="id" title="definition">is_scrambled_trace_test</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="DeepWeb.Spec.Swap_SimpleSpec.html#swap_observer_def"><span class="id" title="definition">Swap_SimpleSpec.swap_observer_def</span></a> <span class="id" title="var">tr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="execute_prop"><span class="id" title="definition">execute_prop</span></a> : <span class="id" title="definition">Checker</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="definition">forAllShrinkNonDet</span> 100 <span class="id" title="method">arbitrary</span> <span class="id" title="method">shrink</span> <a class="idref" href="DeepWeb.Test.TestExternal.html#execute_prop'"><span class="id" title="definition">execute_prop'</span></a>.<br/>

<br/>
<span class="comment">(*!&nbsp;QuickChick&nbsp;execute_prop.&nbsp;*)</span><br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>